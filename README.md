# 1.5.2 Input and Output Architecture

---
## **Detail** 
Verify that serialization is not used when communicating with untrusted clients.If this is not possible,
ensure that adequate integrity controls (andpossibly encryption if sensitive data is sent) are enforced to prevent
deserialization attacks including object injection.

## **ChatGPT**

**ข้อกำหนด:** ตรวจสอบว่าไม่มีการใช้การทำ serialization (การแปลงข้อมูลเป็นรูปแบบที่สามารถส่งผ่านเครือข่ายได้) เมื่อมีการสื่อสารกับผู้ใช้ที่ไม่สามารถเชื่อถือได้ 
หากไม่สามารถหลีกเลี่ยงการใช้ serialization ได้ ต้องมั่นใจว่าได้มีการควบคุมความสมบูรณ์ของข้อมูล (integrity controls) อย่างเพียงพอ 
รวมถึงการเข้ารหัสข้อมูล (encryption) หากมีการส่งข้อมูลที่ละเอียดอ่อน เพื่อป้องกันการโจมตีจากการ deserialization ที่อาจเกิดขึ้นจากการแทรกวัตถุที่ไม่พึงประสงค์ (object injection)

### วิธีป้องกันการโจมตีจาก Deserialization และ Object Injection
1. **หลีกเลี่ยงการใช้ serialization** กับลูกค้าที่ไม่เชื่อถือได้ ถ้าไม่จำเป็น
2. **เข้ารหัสข้อมูล (Encryption)** ก่อนส่งข้อมูลเพื่อป้องกันการแก้ไข
3. **ตรวจสอบความสมบูรณ์ของข้อมูล (Integrity Checks)** เช่น ใช้ HMAC หรือลายเซ็นต์ดิจิตอล
4. **จำกัดประเภทข้อมูลที่ deserialization ได้** ให้เฉพาะข้อมูลที่ปลอดภัย
5. **ทำความสะอาดข้อมูลก่อน deserialization** และตรวจสอบข้อมูลก่อนใช้งาน

---

## **Gemini**

**ข้อกำหนด:** ตรวจสอบให้แน่ใจว่าการแปลงข้อมูลเป็นรูปแบบอนุกรม (Serialization) ไม่ถูกใช้ในการสื่อสารกับลูกค้ารายที่ไม่น่าเชื่อถือ หากไม่สามารถหลีกเลี่ยงได้ 
ให้มั่นใจว่ามีการควบคุมความสมบูรณ์ที่เหมาะสม (และอาจมีการเข้ารหัส หากมีการส่งข้อมูลที่ละเอียดอ่อน) เพื่อป้องกันการโจมตีจากการแปลงข้อมูลกลับเป็นวัตถุ (Deserialization Attacks) 
รวมถึงการแทรกวัตถุ (Object Injection)

### มาตรการป้องกัน:
1. **ตรวจสอบความสมบูรณ์ของข้อมูล:** ใช้ Hash หรือ Digital Signature เพื่อตรวจสอบว่าข้อมูลที่ได้รับไม่ได้ถูกแก้ไข
2. **เข้ารหัสข้อมูลที่ละเอียดอ่อน:** หากมีการส่งข้อมูลที่สำคัญ ควรเข้ารหัสข้อมูลเพื่อป้องกันการดักฟังและการแก้ไข
3. **ใช้ไลบรารี Deserialization ที่ปลอดภัย:** หากจำเป็นต้องใช้ Deserialization ควรใช้ไลบรารีที่ได้รับการตรวจสอบและปรับปรุงความปลอดภัยอย่างสม่ำเสมอ
4. **จำกัดประเภทของวัตถุที่สามารถ Deserialization ได้:** ควรจำกัดเฉพาะประเภทของวัตถุที่จำเป็นเท่านั้น เพื่อลดความเสี่ยงจากการแทรกวัตถุที่ไม่พึงประสงค์

---

## **My self***

เซิร์ฟเวอร์ต้องไม่รับและถอดรหัสข้อมูลจากไคลเอนต์ที่ไม่น่าเชื่อถือโดยไม่มีการตรวจสอบ หากจำเป็นต้องใช้ ต้องมีมาตรการป้องกัน 
เช่น การตรวจสอบความถูกต้องของข้อมูล และการเข้ารหัส (หากเป็นข้อมูลสำคัญ) เพื่อป้องกันการโจมตีจากการถอดรหัสข้อมูล


---
